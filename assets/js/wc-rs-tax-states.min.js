!function(e,t,s){e(function(){var n=e(".wc-rs-tax-state-rows"),a=s.template("wc-rs-tax-state-row"),o=s.template("wc-rs-tax-state-row-blank"),i=Backbone.Model.extend({states:[]}),l=new(Backbone.View.extend({rowTemplate:a,initialize:function(){this.listenTo(this.model,"saved:states",this.render),e(document.body).on("click",".wc-rs-add-tax-state",{view:this},this.onAddState),e(document.body).on("wc_backbone_modal_response",this.onAddStateSubmitted),e(document.body).on("click",".select_all",function(){return e(this).closest("form").find("select option").attr("selected","selected"),e(this).closest("form").find("select").trigger("change"),!1}),e(document.body).on("click",".select_none",function(){return e(this).closest("form").find("select option").removeAttr("selected"),e(this).closest("form").find("select").trigger("change"),!1})},block:function(){e(this.el).block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){e(this.el).unblock()},render:function(){var s=_.indexBy(this.model.get("states"),"abbrev"),n=this;this.$el.empty(),this.unblock(),_.size(s)?(e.each(s,function(e,s){"yes"===s.shipping_taxable?s.shipping_tax_icon='<span class="woocommerce-input-toggle woocommerce-input-toggle--enabled">'+t.strings.yes+"</span>":s.shipping_tax_icon='<span class="woocommerce-input-toggle woocommerce-input-toggle--disabled">'+t.strings.no+"</span>",s.strings=t.strings,n.$el.append(n.rowTemplate(s))}),this.$el.find(".wc-rs-tax-state-delete").on("click",{view:this},this.onDeleteRow),this.$el.find(".wc-rs-shipping-tax-enabled a").on("click",{view:this},this.onToggleEnabled)):n.$el.append(o({strings:t.strings}))},onDeleteRow:function(t){var s=t.data.view,n=s.model,a=_.indexBy(n.get("states"),"abbrev"),o=e(this).closest("tr").data("abbrev");t.preventDefault(),delete a[o],n.set("states",a),s.render()},onToggleEnabled:function(t){var s=t.data.view,n=e(t.target),a=s.model,o=_.indexBy(a.get("states"),"abbrev"),i=n.closest("tr").data("abbrev"),l="yes"===n.closest("tr").data("enabled")?"no":"yes";t.preventDefault(),o[i].shipping_taxable=l,a.set("states",o),s.render()},onAddState:function(s){var n=s.data.view.model,a=_.indexBy(n.get("states"),"abbrev"),o=t.all_states;s.preventDefault();var i=_.filter(o,function(e){return!(e.abbrev in a)});e(this).WCBackboneModal({template:"wc-rs-modal-add-tax-state",variable:{states:i,strings:t.strings}}),e(document.body).trigger("wc-enhanced-select-init")},onAddStateSubmitted:function(e,s,n){if("wc-rs-modal-add-tax-state"===s){var a=l.model,o=_.indexBy(a.get("states"),"abbrev"),i=n.wc_rs_tax_states,c=t.all_states;_.each(i,function(e){o[e]=c[e]}),l.block(),l.model.set("states",o),l.model.trigger("saved:states"),l.unblock()}}}))({model:new i({states:t.tax_states}),el:n});l.render()})}(jQuery,taxStatesLocalizeScript,wp);