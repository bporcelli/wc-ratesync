!function(e,t,s,a){e(function(){e(".wc-rs-tax-states");var a=e(".wc-rs-tax-state-rows"),n=s.template("wc-rs-tax-state-row"),o=s.template("wc-rs-tax-state-row-blank"),i=Backbone.Model.extend({states:[]}),l=new(Backbone.View.extend({rowTemplate:n,initialize:function(){this.listenTo(this.model,"saved:states",this.render),e(document.body).on("click",".wc-rs-add-tax-state",{view:this},this.onAddState),e(document.body).on("wc_backbone_modal_response",this.onAddStateSubmitted),e(document.body).on("click",".select_all",function(){return e(this).closest("form").find("select option").attr("selected","selected"),e(this).closest("form").find("select").trigger("change"),!1}),e(document.body).on("click",".select_none",function(){return e(this).closest("form").find("select option").removeAttr("selected"),e(this).closest("form").find("select").trigger("change"),!1})},block:function(){e(this.el).block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){e(this.el).unblock()},render:function(){var s=_.indexBy(this.model.get("states"),"abbrev"),a=this;this.$el.empty(),this.unblock(),_.size(s)?(e.each(s,function(e,s){"yes"===s.shipping_taxable?s.shipping_tax_icon='<span class="woocommerce-input-toggle woocommerce-input-toggle--enabled">'+t.strings.yes+"</span>":s.shipping_tax_icon='<span class="woocommerce-input-toggle woocommerce-input-toggle--disabled">'+t.strings.no+"</span>",a.$el.append(a.rowTemplate(s));a.$el.find('tr[data-abbrev="'+e+'"]')}),this.$el.find(".wc-rs-tax-state-delete").on("click",{view:this},this.onDeleteRow),this.$el.find(".wc-rs-shipping-tax-enabled a").on("click",{view:this},this.onToggleEnabled)):a.$el.append(o)},onDeleteRow:function(t){var s=t.data.view,a=s.model,n=_.indexBy(a.get("states"),"abbrev"),o=e(this).closest("tr").data("abbrev");t.preventDefault(),delete n[o],a.set("states",n),s.render()},onToggleEnabled:function(t){var s=t.data.view,a=e(t.target),n=s.model,o=_.indexBy(n.get("states"),"abbrev"),i=a.closest("tr").data("abbrev"),l="yes"===a.closest("tr").data("enabled")?"no":"yes";t.preventDefault(),o[i].shipping_taxable=l,n.set("states",o),s.render()},onAddState:function(s){var a=s.data.view.model,n=_.indexBy(a.get("states"),"abbrev"),o=t.all_states;s.preventDefault();var i=_.filter(o,function(e){return!(e.abbrev in n)});e(this).WCBackboneModal({template:"wc-rs-modal-add-tax-state",variable:{states:i}}),e(document.body).trigger("wc-enhanced-select-init")},onAddStateSubmitted:function(e,s,a){if("wc-rs-modal-add-tax-state"===s){var n=l.model,o=_.indexBy(n.get("states"),"abbrev"),i=a.wc_rs_tax_states,c=t.all_states;_.each(i,function(e){o[e]=c[e]}),l.block(),l.model.set("states",o),l.model.trigger("saved:states"),l.unblock()}}}))({model:new i({states:t.tax_states}),el:a});l.render()})}(jQuery,taxStatesLocalizeScript,wp,ajaxurl);